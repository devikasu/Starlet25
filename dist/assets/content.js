console.log("Starlet25 content script loaded");function m(){const e=["main","article",'[role="main"]',".main-content",".content",".post-content",".entry-content","#content","#main"];for(const t of e){const n=document.querySelector(t);if(n)return n}return Array.from(document.querySelectorAll("div, section, p")).filter(t=>(t.textContent||"").length>200&&!t.querySelector("nav, header, footer, aside")).sort((t,n)=>(n.textContent?.length||0)-(t.textContent?.length||0))[0]||null}function d(e){["nav","header","footer","aside",".nav",".navigation",".menu",".sidebar",".footer",".header",'[role="navigation"]','[role="banner"]','[role="contentinfo"]','[role="complementary"]'].forEach(o=>{e.querySelectorAll(o).forEach(a=>a.remove())}),[".ad",".advertisement",".banner",".popup",".modal",".overlay",".cookie-banner",".newsletter-signup",".social-share",".comments",".related-posts",".recommendations"].forEach(o=>{e.querySelectorAll(o).forEach(a=>a.remove())}),e.querySelectorAll("script, style, noscript").forEach(o=>o.remove())}function u(e){return e.replace(/\s+/g," ").replace(/\n\s*\n/g,`
`).trim()}function c(){const e=m();if(!e)return"";const l=e.cloneNode(!0);d(l);let t=l.innerText||l.textContent||"";return t=u(t),t.split(`
`).filter(o=>{const r=o.trim();return r.length>10||r.length===0}).join(`
`).trim()}function s(){const e=c();if(e.length<50){console.log("Starlet25: Not enough text content found");return}const l={type:"PAGE_TEXT",text:e,url:window.location.href,title:document.title,timestamp:Date.now()};chrome.runtime.sendMessage(l,t=>{chrome.runtime.lastError?console.log("Starlet25: Error sending message to background:",chrome.runtime.lastError.message):t&&console.log("Starlet25: Message sent successfully to background")}),console.log("Starlet25: Extracted text length:",e.length)}chrome.runtime.onMessage.addListener((e,l,t)=>{if(e.action==="EXTRACT_TEXT"){const n=c();t({text:n,url:window.location.href,title:document.title})}if(e.action==="APPLY_SATURATION_FILTER"){console.log("ðŸŽ¨ Starlet25: Received APPLY_SATURATION_FILTER command in content script");try{const{saturation:n}=e;console.log("ðŸŽ¨ Starlet25: Applying saturation filter:",n+"%");const o=document.getElementById("starlet25-saturation-filter");if(o&&o.remove(),document.documentElement.style.filter="",document.body.style.filter="",n!==100)try{const r=document.createElement("style");r.id="starlet25-saturation-filter",r.textContent=`
            html {
              filter: saturate(${n}%) !important;
            }
          `,document.head.appendChild(r),console.log("ðŸŽ¨ Starlet25: Saturation filter applied via style element")}catch(r){console.warn("ðŸŽ¨ Style element method failed, trying inline:",r);try{document.documentElement.style.filter=`saturate(${n}%)`,console.log("ðŸŽ¨ Starlet25: Saturation filter applied via inline style")}catch(a){console.warn("ðŸŽ¨ Inline style method failed, trying body:",a),document.body.style.filter=`saturate(${n}%)`,console.log("ðŸŽ¨ Starlet25: Saturation filter applied via body style")}}else console.log("ðŸŽ¨ Starlet25: Saturation reset to normal (100%)");t({success:!0})}catch(n){console.error("ðŸŽ¨ Starlet25: Error applying saturation filter:",n),t({success:!1,error:"Failed to apply saturation filter"})}}});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{s()}):s();let i=0;const f=new MutationObserver(()=>{const e=c();Math.abs(e.length-i)>100&&(i=e.length,s())});f.observe(document.body,{childList:!0,subtree:!0});
